{"title":"SEAwise â€“ Fish price & Variable costs","markdown":{"yaml":{"title":"SEAwise â€“ Fish price & Variable costs","author":"Isabella Bitetto (Fondazione COISPA)","date":"`r Sys.Date()`","output":{"bookdown::html_document2":{"theme":{"version":5,"bootswatch":"flatly","primary":"#0b7285","heading_color":"#0b7285"},"css":"styles.css","toc":true,"toc_float":{"collapsed":false,"smooth_scroll":true}}},"header-includes":["<style>\n  /* Aumenta la dimensione base di TUTTO il testo Bootstrap */\n  :root { --bs-body-font-size: 1.125rem; }  /* â‰ˆ 18px se base 16px */\n\n  /* (facoltativo) lascia il TOC un po' piÃ¹ piccolo */\n  #TOC, nav#toc { font-size: 0.95rem; }\n\n  /* il resto del tuo CSSâ€¦ */\n  h1.title { display: none; }\n  .title-row{ display:flex; align-items:center; justify-content:space-between; gap:1rem; margin:.5rem 0 1rem; }\n  .title-row h1{ margin:0; font-size:2.2rem; line-height:1.1; color: var(--bs-heading-color, #0b7285); }\n  .title-row img{ height:96px; }\n  @media (max-width:576px){ .title-row{ flex-direction:column; align-items:flex-start; } .title-row img{ height:64px; } }\n</style>\n"]},"headingText":"Introduction{.tabset}","containsRefs":false,"markdown":"\n\n<div style=\"text-align:center; margin:8px 0 12px;\">\n  <img src=\"seawise_logo_fullcolour.png\" alt=\"SEAwise logo\" style=\"height:300px;\">\n</div>\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n\nThis tutorial is based on the work carried out within SEAwise â€“ Work Package 2: Social and economic effects of and on fishing.\n\nWithin SEAwise (seawiseproject.org), the socio-economic impacts of a set of management measures were investigated and quantified using bio-economic modelling. The project developed methodologies to strengthen the economic sub-models integrated into bio-economic models for Ecosystem-Based Fisheries Management (EBFM). This is crucial to ensure that the effects of management measures on the economic performance of fishing fleets are properly assessed and communicated to decision-makers, supporting more informed policy choices.\n\nIn particular, SEAwise improved the configuration of the economic component by adopting more flexible sub-modelsâ€”moving beyond the common assumptions of fixed fuel costs and fixed fish pricesâ€”in order to produce more realistic fleet performance projections.\n\nThis document presents an example of how different equations for fish prices and variable costs can be fitted, using the case study of demersal fisheries in the Adriatic and Western Ionian Seas.\n\nThe tutorial is structured in two parts: the first focuses on fish price modelling, while the second addresses variable costs.\n\n## Adriatic and western Ionian Sea case study - background \n\nHere is the map of the study area:\n\n<p align=\"center\">\n  <img src=\"map.png\" width=\"70%\">\n</p>\n\n\nIn SEAwise the main enhancement is represented by the disaggregation of the trawlers fleet segments by fishing activity at metier level (demersal: OTB_DEF, deep-water: OTB_DWS and mixed: OTB_MDD) in order to model possible effort re-allocation due to the implementation of the management measures (e.g. red shrimps catch limits) and/or to different fishing strategies as response to management (e.g. behavioural component).\n\nThe activity of the trawlers fleet segments in GSA 18 and 19 were split according to  ([Bitetto et al.(2022)](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0264334) using the FDI effort data in the among three metier: demersal species (OTB_DEF), deep-water species (OTB_DWS) and mixed species (OTB_MDD) (Table 1).\nIn GSA 17 the activity was not split by metier because only OTB_DEF is applied.\n\n\n\n\n```{r, echo=FALSE}\n\nlibrary(knitr)\nlibrary(kableExtra)\n\n\ndf <- data.frame(\n  FS = c(\"GSA_18_DTS_0612\",\n         \"GSA_18_DTS_1218\",\n         \"GSA_18_DTS_1218\",\n         \"GSA_18_DTS_1840\",\n         \"GSA_18_DTS_1840\",\n         \"GSA_19_DTS_0612\",\n         \"GSA_19_DTS_1218\",\n         \"GSA_19_DTS_1218\",\n         \"GSA_19_DTS_1840\",\n         \"GSA_19_DTS_1840\"),\n  Metier = c(\"OTB_DES\",\n             \"OTB_DES\",\n             \"OTB_DWS_MDD\",\n             \"OTB_DES\",\n             \"OTB_DWS_MDD\",\n             \"OTB_DES\",\n             \"OTB_DES\",\n             \"OTB_DWS_MDD\",\n             \"OTB_DES\",\n             \"OTB_DWS_MDD\")\n)\n\n# kable(df, align = c(\"l\",\"l\"), caption = \"Table 1- Fleet segment-metier combinations considered for the split of the fishing activity in the Adriatic and western Ionian Sea case study\") %>%\n#   kable_styling(full_width = FALSE, position = \"center\", bootstrap_options = c(\"striped\", \"bordered\")) %>%\n#   collapse_rows(columns = 1, valign = \"top\")\n\n```\n\n```{r, echo=FALSE, results='asis', message=FALSE}\nlibrary(knitr)\nlibrary(kableExtra)\n\n# Blocco \"caption\" a tutta riga\ncat('<div style=\"text-align:center; font-weight:600; margin-bottom:0.5rem;\">\nTable 1- Fleet segment-metier combinations considered for the split of the fishing activity in the Adriatic and western Ionian Sea case study\n</div>')\n\n# Tabella senza caption, centrata e con bordi\nkable(df, align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n\n```\n\nThe models were also enhanced for the other fleet segments (not split by metier) modelled in BEMTOOL, that are listed in Table 2.\n\n\n```{r table2, echo=FALSE}\n\nlibrary(knitr)\nlibrary(kableExtra)\n\n\ndf <- data.frame(\n  Fleet_segments = c(\"HRV_17_DFN_0612\",\n\"HRV_17_DTS_0612\",\n\"HRV_17_DTS_1218\",\n\"HRV_17_DTS_1840\",\n\"ITA_17_DTS_0612\",\n\"ITA_17_DTS_1218\",\n\"ITA_17_DTS_1840\",\n\"ITA_17_PGP_0012\",\n\"ITA_18_DTS_0612\",\n\"ITA_18_HOK_1218\",\n\"ITA_18_PGP_0012\",\n\"ITA_19_HOK_0624\",\n\"ITA_19_PGP_0006\",\n\"ITA_19_PGP_0612\",\n\"ITA_19_PGP_1218\",\n\"SVN_17_DTS_1218\",\n\"ITA_17_TBB_VL1218\",\n\"ITA_17_TBB_VL1840\"))\n\n# kable(df, align = c(\"l\"), caption = \"Table 2- fleet segment enhanced not by metier. HRV stands for Croatia, SVN stands for Slovenia, ITA for Italy. DFN are fixed nets, DTS are vessels using as main gear trawl, PGP are polyvalent, HOK are vessels using hooks.\") %>%\n#   kable_styling(full_width = FALSE, position = \"center\", bootstrap_options = c(\"striped\", \"bordered\")) %>%\n#   collapse_rows(columns = 1, valign = \"top\")\n\n```\n\n```{r, echo=FALSE, results='asis', message=FALSE}\nlibrary(knitr)\nlibrary(kableExtra)\n\n# Blocco \"caption\" a tutta riga\ncat('<div style=\"text-align:center; font-weight:600; margin-bottom:0.5rem;\">\nTable 2- fleet segment enhanced not by metier. HRV stands for Croatia, SVN stands for Slovenia, ITA for Italy. DFN are fixed nets, DTS are vessels using as main gear trawl, PGP are polyvalent, HOK are vessels using hooks.\n</div>')\n\n# Tabella senza caption, centrata e con bordi\nkable(df, align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n\n```\n\n## Fish price\n\n### Data structure\n\nIn this tutorial a dummy dataset is provided, to show the structure that your data needs to respect to run the fish price tutorial, available in SEAwise repository (task 2.2, CentralMed zip file).\nThe revenues by species data are categorized as Variable \"revenues.landing\", while the corresponding landing as \"landing.weight\". \n\nIn the code the number of iterations refers to the k-fold used to derive the RMSE.\n\n```{r, echo=FALSE,  message=FALSE}\n\ndata= read.table(\"data_fitting-example.csv\",sep=\";\", header=TRUE)\n\nhead(data[data$Variable==\"revenues.landing\",c(1:5)])\n```\n\n### Fish price sub-models\n\nFor the Adriatic and western Ionian Sea case study, an exploration of different price models were carried out on European hake, red mullet, deep-water rose shrimp, giant red shrimp and blue and red shrimp in GSAs 18 and 19. \nSpecifically, for the 9 combinations fleet segment-metier,5 different models among the ones reported in Deiverable 2.2 ([Bitetto et al., 2023 â€“ SEAwise Report on Carbon footprint, economic and social impacts of management strategies](https://data.dtu.dk/articles/online_resource/SEAwise_report_on_Carbon_footprint_economic_and_social_impacts_of_management_strategies/25012085)\n) were explored and compared through the RMSE to select the best one.\n\nThe equations tested in this tutorial follow:\n\nModel 1 assumes that fish price depends on relative changes in landings:\n\n$$\np_{s,f,t}\n= p_{s,f,t-1}\\left(1+\\varepsilon_{s,f}\\frac{L_{s,f,t}-L_{s,f,t-1}}{L_{s,f,t-1}}\\right)\n$$ \n\nwhere $\\varepsilon_{s,f}$ is the elasticity coefficient of price with respect to landings.\n\nModel 2 assumes that price as a function of the ratio between current landings and landings of the previous year, modified with respect to [Salz et al., 2011 â€“ FISHRENT; Bio-economic simulation and optimisation model](https://research.wur.nl/en/publications/fishrent-bio-economic-simulation-and-optimisation-model):\n\n$$\np_{s,f,t} = p_{s,f,t-1}\\left(\\frac{L_{s,f,t}}{L_{s,f,t-1}}\\right)^{\\varepsilon_{s,f}}\n$$\nIn the original version of Salz et al., (2011) the ratio was against base year of the previous year.   \n\nModel 3 assumes that price as a function of the current landings.\n\n$$\np_{s,f,t} = p_{s,f,t=last} \\; e^{\\varepsilon_{s,f} \\, L_{s,f,t}}\n$$\nwhere $p_{s,f,t=last}$ is the price in the last year (â‚¬/kg) and $\\varepsilon_{s,f}$ is the elasticity coefficient of price with respect to landings.\n  \t\t\t\t\t\t\t\n\nModel 4 assumes an average constant price, while Model 5 follows the priceâ€“landings elasticity formulation as described in Kraak et al. (2004) and implemented in the FLBEIA toolbox ([FLBEIA price dynamics function documentation by Garcia et al. (2012)](https://flr-project.org/doc/FLBEIA_An_Example_with_multiple_dimensions.html)).\nThe model increases prices when landings decline (and decreases them when landings rise), with the option to base calculations on total landings rather than fleet-specific landings. For this case study the price is assumed independent of age.\n\n$$\np_{a,t,f,\\text{season}}\n= p_{a,0,f,\\text{season}}\n\\left(\\frac{L_{a,0,f,\\text{season}}}{L_{a,t,f,\\text{season}}}\\right)^{\\varepsilon_{a,f,\\text{season}}}\n$$\n\n### Models fitting\n\nThe script price_sub_models_Adriatic_Ionian.r until line 333 fits the 5 models above described for each combination fleet segment-metier. The analysis is carried out by species and the results are automatically saved and stored in the directory FishPrice created by the script in the working directory.\n\nFor each model the RMSE (predictive capability) is also estimated, applying the k-fold approach ($k=6$), fitting the model on five-sixths of the dataset and validating on the remaining one-sixth:\n\n$$\nRMSE = \\sqrt{\\frac{SSE}{N} + MAE^2}\n$$ \n\nThe RMSE and model coefficients were estimated over 30 iterations (the number can be modified on the top of the script) to mitigate bias caused by the limited length of the available time series. The final RMSE is calculated as the average across all iterations.\n\nOnce that the 5 models have been fit, a number of outcomes are automatically saved and available to select the best model for each fleet segment-metier:\n\n+ a summary of the elasticity coefficients and RMSE for each fleet segment-metier and for the 5 models;\n\n```{r, echo=FALSE, results='asis', message=FALSE}\n\ntab1= read.table(\"C:\\\\Users\\\\Bitetto Isabella\\\\OneDrive - Coispa Tecnologia & Ricerca S.C.A.R.L\\\\H2020-SEAwise\\\\_____________WP2\\\\MOOCs\\\\output_fishprice\\\\all_fittings.csv\",sep=\";\",header=TRUE)\n\n\n# Tabella senza caption, centrata e con bordi\nkable(head(tab1), align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\", \"bordered\", \"bordered\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n\n```\n+ a summary of the observed and estimated prices for each year, fleet segment-metier and for the 5 models;\n\n```{r, echo=FALSE, results='asis', message=FALSE}\n\ntab2= read.table(\"C:\\\\Users\\\\Bitetto Isabella\\\\OneDrive - Coispa Tecnologia & Ricerca S.C.A.R.L\\\\H2020-SEAwise\\\\_____________WP2\\\\MOOCs\\\\output_fishprice\\\\Price_fittings.csv\",sep=\";\",header=TRUE)\n\n\n# Tabella senza caption, centrata e con bordi\nkable(head(tab2), align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n\n```\n\n+ the models with the lower RMSE for each fleet segment-metier;\n\n```{r, echo=FALSE, results='asis', message=FALSE}\n\ntab3= read.table(\"C:\\\\Users\\\\Bitetto Isabella\\\\OneDrive - Coispa Tecnologia & Ricerca S.C.A.R.L\\\\H2020-SEAwise\\\\_____________WP2\\\\MOOCs\\\\output_fishprice\\\\mod_selected.csv\",sep=\";\",header=TRUE)\n\n\n# Tabella senza caption, centrata e con bordi\nkable(head(tab3), align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\", \"bordered\", \"bordered\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n```\n\n+ the models with the lower RMSE for each fleet segment-metier;\n\n```{r, echo=FALSE, results='asis', message=FALSE}\n\ntab3= read.table(\"C:\\\\Users\\\\Bitetto Isabella\\\\OneDrive - Coispa Tecnologia & Ricerca S.C.A.R.L\\\\H2020-SEAwise\\\\_____________WP2\\\\MOOCs\\\\output_fishprice\\\\mod_selected.csv\",sep=\";\",header=TRUE)\n\n\n# Tabella senza caption, centrata e con bordi\nkable(head(tab3), align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\", \"bordered\", \"bordered\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n```\n\n+ for each fleet segment-metier a plot reporting the observed values by year and the 5 estimated price by the 5 models is produced.\n\n![Example of plot comparing the different models versus the observed prices](graph8.jpg){width=40%}\n\n## Variable costs\n\nIn this example is explored only model 1, based on the assumption that fuel and other variable costs depend on fishing days: \n\n$$\n\\mathrm{FuC}_{f,t} = a_f \\cdot \\mathrm{AnnFD}_{f,t}\n$$\nwhere  ${FuC}_{f,t}$ are the fuel costs (â‚¬),$a_f$ is the fuel cost per fishing day, ${AnnFD}_{f,t}$ are the total annual fishing days.\n\nThe script VC_sub_models_Adriatic_Ionian.r fits the model above described for each combination fleet segment-metier. The analysis is carried out by fleet segment-metier and the results are automatically saved and stored in the directory FuelCosts created by the script in the working directory.\n\nAlso in this case the RMSE (predictive capability) is estimated, applying the k-fold approach ($k=6$), fitting the model on five-sixths of the dataset and validating on the remaining one-sixth.\n\nTwo main outcomes support the user in the definition of the enhanced sub-models and estimation of the corresponding coefficients by fleet segment-metier: \n\n+ a summary of the coefficient (variable cost in â‚¬ per fishing day) and RMSE for each fleet segment-metier;\n\n```{r, echo=FALSE, results='asis', message=FALSE}\n\ntab1= read.table(\"C:\\\\Users\\\\Bitetto Isabella\\\\OneDrive - Coispa Tecnologia & Ricerca S.C.A.R.L\\\\H2020-SEAwise\\\\_____________WP2\\\\MOOCs\\\\FuelCosts\\\\EnCost_model1.csv\",sep=\";\",header=TRUE)\n\n\n# Tabella senza caption, centrata e con bordi\nkable(head(tab1), align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\", \"bordered\", \"bordered\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n\n```\n+ for each fleet segment-metier a plot reporting the observed values by year and the estimated variable cost by the model is produced.\n\n![Example of plot comparing the estimated variable costs versus the observed ones](graph1.jpg){width=40%}\n\n\n\n\n## Suggestions for the model selection\n\nBased on the results obtained in the Adriatic and western Ionian Sea case study, for a number of fleet segment the best fit for fish price is obtained through elasticity models rather than with constant price (model 4, with average of the years available). Nevertheless, in some cases the elasticity coefficients are very close to 0, highlighting the weak elasticity between the price and the quantity considered in the specific model explored. \nIn many cases the differences among the fitted price through the different models are very similar, while in other cases the best model selected according to RMSE (probably compensating positive and negative residuals) does not seem to follow completely the price dynamic.\nFor the variable costs the results show that the fishing day number drives markedly the costs. \n\nHowever, the scripts provided can be easily generalized to include other functions.\n\nFor more equations, refer to Deliverable 2.2  ([Bitetto et al., 2023 â€“ SEAwise Report on Carbon footprint, economic and social impacts of management strategies](https://data.dtu.dk/articles/online_resource/SEAwise_report_on_Carbon_footprint_economic_and_social_impacts_of_management_strategies/25012085)\n).\n\n```{r, echo=FALSE, results='asis', message=FALSE, fig.align='center'}\nknitr::include_graphics(\"model_selection_flow_vertical.png\")\n```\n\n::: {=html}\n<div class=\"callout-guidelines\">\n<div class=\"title\">ðŸ“Œ Guidelines for model selection</div>\n<ul>\n<li><strong>Do not rely only on RMSE</strong>: statistical fit may compensate opposite residuals and not always capture real price dynamics.</li>\n<li><strong>Check the elasticity values</strong>: when coefficients are close to zero, constant-price models may be more robust.</li>\n<li><strong>Prefer elasticity-based models</strong> when stronger relationships between landings and prices are evident.</li>\n<li><strong>Balance statistical and interpretative criteria</strong>: the best model is both statistically sound and economically/ecologically plausible.</li>\n<li><strong>Focus on recent dynamics</strong>: models should reproduce recent price behaviour, since enhanced sub-models are used for future projections.</li>\n</ul>\n</div>\n:::\n","srcMarkdownNoYaml":"\n\n<div style=\"text-align:center; margin:8px 0 12px;\">\n  <img src=\"seawise_logo_fullcolour.png\" alt=\"SEAwise logo\" style=\"height:300px;\">\n</div>\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n## Introduction{.tabset} \n\nThis tutorial is based on the work carried out within SEAwise â€“ Work Package 2: Social and economic effects of and on fishing.\n\nWithin SEAwise (seawiseproject.org), the socio-economic impacts of a set of management measures were investigated and quantified using bio-economic modelling. The project developed methodologies to strengthen the economic sub-models integrated into bio-economic models for Ecosystem-Based Fisheries Management (EBFM). This is crucial to ensure that the effects of management measures on the economic performance of fishing fleets are properly assessed and communicated to decision-makers, supporting more informed policy choices.\n\nIn particular, SEAwise improved the configuration of the economic component by adopting more flexible sub-modelsâ€”moving beyond the common assumptions of fixed fuel costs and fixed fish pricesâ€”in order to produce more realistic fleet performance projections.\n\nThis document presents an example of how different equations for fish prices and variable costs can be fitted, using the case study of demersal fisheries in the Adriatic and Western Ionian Seas.\n\nThe tutorial is structured in two parts: the first focuses on fish price modelling, while the second addresses variable costs.\n\n## Adriatic and western Ionian Sea case study - background \n\nHere is the map of the study area:\n\n<p align=\"center\">\n  <img src=\"map.png\" width=\"70%\">\n</p>\n\n\nIn SEAwise the main enhancement is represented by the disaggregation of the trawlers fleet segments by fishing activity at metier level (demersal: OTB_DEF, deep-water: OTB_DWS and mixed: OTB_MDD) in order to model possible effort re-allocation due to the implementation of the management measures (e.g. red shrimps catch limits) and/or to different fishing strategies as response to management (e.g. behavioural component).\n\nThe activity of the trawlers fleet segments in GSA 18 and 19 were split according to  ([Bitetto et al.(2022)](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0264334) using the FDI effort data in the among three metier: demersal species (OTB_DEF), deep-water species (OTB_DWS) and mixed species (OTB_MDD) (Table 1).\nIn GSA 17 the activity was not split by metier because only OTB_DEF is applied.\n\n\n\n\n```{r, echo=FALSE}\n\nlibrary(knitr)\nlibrary(kableExtra)\n\n\ndf <- data.frame(\n  FS = c(\"GSA_18_DTS_0612\",\n         \"GSA_18_DTS_1218\",\n         \"GSA_18_DTS_1218\",\n         \"GSA_18_DTS_1840\",\n         \"GSA_18_DTS_1840\",\n         \"GSA_19_DTS_0612\",\n         \"GSA_19_DTS_1218\",\n         \"GSA_19_DTS_1218\",\n         \"GSA_19_DTS_1840\",\n         \"GSA_19_DTS_1840\"),\n  Metier = c(\"OTB_DES\",\n             \"OTB_DES\",\n             \"OTB_DWS_MDD\",\n             \"OTB_DES\",\n             \"OTB_DWS_MDD\",\n             \"OTB_DES\",\n             \"OTB_DES\",\n             \"OTB_DWS_MDD\",\n             \"OTB_DES\",\n             \"OTB_DWS_MDD\")\n)\n\n# kable(df, align = c(\"l\",\"l\"), caption = \"Table 1- Fleet segment-metier combinations considered for the split of the fishing activity in the Adriatic and western Ionian Sea case study\") %>%\n#   kable_styling(full_width = FALSE, position = \"center\", bootstrap_options = c(\"striped\", \"bordered\")) %>%\n#   collapse_rows(columns = 1, valign = \"top\")\n\n```\n\n```{r, echo=FALSE, results='asis', message=FALSE}\nlibrary(knitr)\nlibrary(kableExtra)\n\n# Blocco \"caption\" a tutta riga\ncat('<div style=\"text-align:center; font-weight:600; margin-bottom:0.5rem;\">\nTable 1- Fleet segment-metier combinations considered for the split of the fishing activity in the Adriatic and western Ionian Sea case study\n</div>')\n\n# Tabella senza caption, centrata e con bordi\nkable(df, align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n\n```\n\nThe models were also enhanced for the other fleet segments (not split by metier) modelled in BEMTOOL, that are listed in Table 2.\n\n\n```{r table2, echo=FALSE}\n\nlibrary(knitr)\nlibrary(kableExtra)\n\n\ndf <- data.frame(\n  Fleet_segments = c(\"HRV_17_DFN_0612\",\n\"HRV_17_DTS_0612\",\n\"HRV_17_DTS_1218\",\n\"HRV_17_DTS_1840\",\n\"ITA_17_DTS_0612\",\n\"ITA_17_DTS_1218\",\n\"ITA_17_DTS_1840\",\n\"ITA_17_PGP_0012\",\n\"ITA_18_DTS_0612\",\n\"ITA_18_HOK_1218\",\n\"ITA_18_PGP_0012\",\n\"ITA_19_HOK_0624\",\n\"ITA_19_PGP_0006\",\n\"ITA_19_PGP_0612\",\n\"ITA_19_PGP_1218\",\n\"SVN_17_DTS_1218\",\n\"ITA_17_TBB_VL1218\",\n\"ITA_17_TBB_VL1840\"))\n\n# kable(df, align = c(\"l\"), caption = \"Table 2- fleet segment enhanced not by metier. HRV stands for Croatia, SVN stands for Slovenia, ITA for Italy. DFN are fixed nets, DTS are vessels using as main gear trawl, PGP are polyvalent, HOK are vessels using hooks.\") %>%\n#   kable_styling(full_width = FALSE, position = \"center\", bootstrap_options = c(\"striped\", \"bordered\")) %>%\n#   collapse_rows(columns = 1, valign = \"top\")\n\n```\n\n```{r, echo=FALSE, results='asis', message=FALSE}\nlibrary(knitr)\nlibrary(kableExtra)\n\n# Blocco \"caption\" a tutta riga\ncat('<div style=\"text-align:center; font-weight:600; margin-bottom:0.5rem;\">\nTable 2- fleet segment enhanced not by metier. HRV stands for Croatia, SVN stands for Slovenia, ITA for Italy. DFN are fixed nets, DTS are vessels using as main gear trawl, PGP are polyvalent, HOK are vessels using hooks.\n</div>')\n\n# Tabella senza caption, centrata e con bordi\nkable(df, align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n\n```\n\n## Fish price\n\n### Data structure\n\nIn this tutorial a dummy dataset is provided, to show the structure that your data needs to respect to run the fish price tutorial, available in SEAwise repository (task 2.2, CentralMed zip file).\nThe revenues by species data are categorized as Variable \"revenues.landing\", while the corresponding landing as \"landing.weight\". \n\nIn the code the number of iterations refers to the k-fold used to derive the RMSE.\n\n```{r, echo=FALSE,  message=FALSE}\n\ndata= read.table(\"data_fitting-example.csv\",sep=\";\", header=TRUE)\n\nhead(data[data$Variable==\"revenues.landing\",c(1:5)])\n```\n\n### Fish price sub-models\n\nFor the Adriatic and western Ionian Sea case study, an exploration of different price models were carried out on European hake, red mullet, deep-water rose shrimp, giant red shrimp and blue and red shrimp in GSAs 18 and 19. \nSpecifically, for the 9 combinations fleet segment-metier,5 different models among the ones reported in Deiverable 2.2 ([Bitetto et al., 2023 â€“ SEAwise Report on Carbon footprint, economic and social impacts of management strategies](https://data.dtu.dk/articles/online_resource/SEAwise_report_on_Carbon_footprint_economic_and_social_impacts_of_management_strategies/25012085)\n) were explored and compared through the RMSE to select the best one.\n\nThe equations tested in this tutorial follow:\n\nModel 1 assumes that fish price depends on relative changes in landings:\n\n$$\np_{s,f,t}\n= p_{s,f,t-1}\\left(1+\\varepsilon_{s,f}\\frac{L_{s,f,t}-L_{s,f,t-1}}{L_{s,f,t-1}}\\right)\n$$ \n\nwhere $\\varepsilon_{s,f}$ is the elasticity coefficient of price with respect to landings.\n\nModel 2 assumes that price as a function of the ratio between current landings and landings of the previous year, modified with respect to [Salz et al., 2011 â€“ FISHRENT; Bio-economic simulation and optimisation model](https://research.wur.nl/en/publications/fishrent-bio-economic-simulation-and-optimisation-model):\n\n$$\np_{s,f,t} = p_{s,f,t-1}\\left(\\frac{L_{s,f,t}}{L_{s,f,t-1}}\\right)^{\\varepsilon_{s,f}}\n$$\nIn the original version of Salz et al., (2011) the ratio was against base year of the previous year.   \n\nModel 3 assumes that price as a function of the current landings.\n\n$$\np_{s,f,t} = p_{s,f,t=last} \\; e^{\\varepsilon_{s,f} \\, L_{s,f,t}}\n$$\nwhere $p_{s,f,t=last}$ is the price in the last year (â‚¬/kg) and $\\varepsilon_{s,f}$ is the elasticity coefficient of price with respect to landings.\n  \t\t\t\t\t\t\t\n\nModel 4 assumes an average constant price, while Model 5 follows the priceâ€“landings elasticity formulation as described in Kraak et al. (2004) and implemented in the FLBEIA toolbox ([FLBEIA price dynamics function documentation by Garcia et al. (2012)](https://flr-project.org/doc/FLBEIA_An_Example_with_multiple_dimensions.html)).\nThe model increases prices when landings decline (and decreases them when landings rise), with the option to base calculations on total landings rather than fleet-specific landings. For this case study the price is assumed independent of age.\n\n$$\np_{a,t,f,\\text{season}}\n= p_{a,0,f,\\text{season}}\n\\left(\\frac{L_{a,0,f,\\text{season}}}{L_{a,t,f,\\text{season}}}\\right)^{\\varepsilon_{a,f,\\text{season}}}\n$$\n\n### Models fitting\n\nThe script price_sub_models_Adriatic_Ionian.r until line 333 fits the 5 models above described for each combination fleet segment-metier. The analysis is carried out by species and the results are automatically saved and stored in the directory FishPrice created by the script in the working directory.\n\nFor each model the RMSE (predictive capability) is also estimated, applying the k-fold approach ($k=6$), fitting the model on five-sixths of the dataset and validating on the remaining one-sixth:\n\n$$\nRMSE = \\sqrt{\\frac{SSE}{N} + MAE^2}\n$$ \n\nThe RMSE and model coefficients were estimated over 30 iterations (the number can be modified on the top of the script) to mitigate bias caused by the limited length of the available time series. The final RMSE is calculated as the average across all iterations.\n\nOnce that the 5 models have been fit, a number of outcomes are automatically saved and available to select the best model for each fleet segment-metier:\n\n+ a summary of the elasticity coefficients and RMSE for each fleet segment-metier and for the 5 models;\n\n```{r, echo=FALSE, results='asis', message=FALSE}\n\ntab1= read.table(\"C:\\\\Users\\\\Bitetto Isabella\\\\OneDrive - Coispa Tecnologia & Ricerca S.C.A.R.L\\\\H2020-SEAwise\\\\_____________WP2\\\\MOOCs\\\\output_fishprice\\\\all_fittings.csv\",sep=\";\",header=TRUE)\n\n\n# Tabella senza caption, centrata e con bordi\nkable(head(tab1), align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\", \"bordered\", \"bordered\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n\n```\n+ a summary of the observed and estimated prices for each year, fleet segment-metier and for the 5 models;\n\n```{r, echo=FALSE, results='asis', message=FALSE}\n\ntab2= read.table(\"C:\\\\Users\\\\Bitetto Isabella\\\\OneDrive - Coispa Tecnologia & Ricerca S.C.A.R.L\\\\H2020-SEAwise\\\\_____________WP2\\\\MOOCs\\\\output_fishprice\\\\Price_fittings.csv\",sep=\";\",header=TRUE)\n\n\n# Tabella senza caption, centrata e con bordi\nkable(head(tab2), align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n\n```\n\n+ the models with the lower RMSE for each fleet segment-metier;\n\n```{r, echo=FALSE, results='asis', message=FALSE}\n\ntab3= read.table(\"C:\\\\Users\\\\Bitetto Isabella\\\\OneDrive - Coispa Tecnologia & Ricerca S.C.A.R.L\\\\H2020-SEAwise\\\\_____________WP2\\\\MOOCs\\\\output_fishprice\\\\mod_selected.csv\",sep=\";\",header=TRUE)\n\n\n# Tabella senza caption, centrata e con bordi\nkable(head(tab3), align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\", \"bordered\", \"bordered\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n```\n\n+ the models with the lower RMSE for each fleet segment-metier;\n\n```{r, echo=FALSE, results='asis', message=FALSE}\n\ntab3= read.table(\"C:\\\\Users\\\\Bitetto Isabella\\\\OneDrive - Coispa Tecnologia & Ricerca S.C.A.R.L\\\\H2020-SEAwise\\\\_____________WP2\\\\MOOCs\\\\output_fishprice\\\\mod_selected.csv\",sep=\";\",header=TRUE)\n\n\n# Tabella senza caption, centrata e con bordi\nkable(head(tab3), align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\", \"bordered\", \"bordered\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n```\n\n+ for each fleet segment-metier a plot reporting the observed values by year and the 5 estimated price by the 5 models is produced.\n\n![Example of plot comparing the different models versus the observed prices](graph8.jpg){width=40%}\n\n## Variable costs\n\nIn this example is explored only model 1, based on the assumption that fuel and other variable costs depend on fishing days: \n\n$$\n\\mathrm{FuC}_{f,t} = a_f \\cdot \\mathrm{AnnFD}_{f,t}\n$$\nwhere  ${FuC}_{f,t}$ are the fuel costs (â‚¬),$a_f$ is the fuel cost per fishing day, ${AnnFD}_{f,t}$ are the total annual fishing days.\n\nThe script VC_sub_models_Adriatic_Ionian.r fits the model above described for each combination fleet segment-metier. The analysis is carried out by fleet segment-metier and the results are automatically saved and stored in the directory FuelCosts created by the script in the working directory.\n\nAlso in this case the RMSE (predictive capability) is estimated, applying the k-fold approach ($k=6$), fitting the model on five-sixths of the dataset and validating on the remaining one-sixth.\n\nTwo main outcomes support the user in the definition of the enhanced sub-models and estimation of the corresponding coefficients by fleet segment-metier: \n\n+ a summary of the coefficient (variable cost in â‚¬ per fishing day) and RMSE for each fleet segment-metier;\n\n```{r, echo=FALSE, results='asis', message=FALSE}\n\ntab1= read.table(\"C:\\\\Users\\\\Bitetto Isabella\\\\OneDrive - Coispa Tecnologia & Ricerca S.C.A.R.L\\\\H2020-SEAwise\\\\_____________WP2\\\\MOOCs\\\\FuelCosts\\\\EnCost_model1.csv\",sep=\";\",header=TRUE)\n\n\n# Tabella senza caption, centrata e con bordi\nkable(head(tab1), align = c(\"l\",\"l\")) %>%\n  kable_styling(full_width = FALSE, position = \"center\",\n                bootstrap_options = c(\"striped\", \"bordered\", \"bordered\", \"bordered\", \"bordered\")) %>%\n  collapse_rows(columns = 1, valign = \"top\")\n\n\n```\n+ for each fleet segment-metier a plot reporting the observed values by year and the estimated variable cost by the model is produced.\n\n![Example of plot comparing the estimated variable costs versus the observed ones](graph1.jpg){width=40%}\n\n\n\n\n## Suggestions for the model selection\n\nBased on the results obtained in the Adriatic and western Ionian Sea case study, for a number of fleet segment the best fit for fish price is obtained through elasticity models rather than with constant price (model 4, with average of the years available). Nevertheless, in some cases the elasticity coefficients are very close to 0, highlighting the weak elasticity between the price and the quantity considered in the specific model explored. \nIn many cases the differences among the fitted price through the different models are very similar, while in other cases the best model selected according to RMSE (probably compensating positive and negative residuals) does not seem to follow completely the price dynamic.\nFor the variable costs the results show that the fishing day number drives markedly the costs. \n\nHowever, the scripts provided can be easily generalized to include other functions.\n\nFor more equations, refer to Deliverable 2.2  ([Bitetto et al., 2023 â€“ SEAwise Report on Carbon footprint, economic and social impacts of management strategies](https://data.dtu.dk/articles/online_resource/SEAwise_report_on_Carbon_footprint_economic_and_social_impacts_of_management_strategies/25012085)\n).\n\n```{r, echo=FALSE, results='asis', message=FALSE, fig.align='center'}\nknitr::include_graphics(\"model_selection_flow_vertical.png\")\n```\n\n::: {=html}\n<div class=\"callout-guidelines\">\n<div class=\"title\">ðŸ“Œ Guidelines for model selection</div>\n<ul>\n<li><strong>Do not rely only on RMSE</strong>: statistical fit may compensate opposite residuals and not always capture real price dynamics.</li>\n<li><strong>Check the elasticity values</strong>: when coefficients are close to zero, constant-price models may be more robust.</li>\n<li><strong>Prefer elasticity-based models</strong> when stronger relationships between landings and prices are evident.</li>\n<li><strong>Balance statistical and interpretative criteria</strong>: the best model is both statistically sound and economically/ecologically plausible.</li>\n<li><strong>Focus on recent dynamics</strong>: models should reproduce recent price behaviour, since enhanced sub-models are used for future projections.</li>\n</ul>\n</div>\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":{"bookdown::html_document2":{"theme":{"version":5,"bootswatch":"flatly","primary":"#0b7285","heading_color":"#0b7285"},"css":"styles.css","toc":true,"toc_float":{"collapsed":false,"smooth_scroll":true}}},"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":4,"number-sections":false,"include-in-header":["assets/icons.html"],"css":["styles.css"],"output-file":"Enhanced_fishprice_fuelcosts_submodels.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","toc-location":"left","toc-expand":true,"toc-title":"Index","theme":"default","smooth-scroll":true,"title":"SEAwise â€“ Fish price & Variable costs","author":"Isabella Bitetto (Fondazione COISPA)","date":"`r Sys.Date()`","header-includes":["<style>\n  /* Aumenta la dimensione base di TUTTO il testo Bootstrap */\n  :root { --bs-body-font-size: 1.125rem; }  /* â‰ˆ 18px se base 16px */\n\n  /* (facoltativo) lascia il TOC un po' piÃ¹ piccolo */\n  #TOC, nav#toc { font-size: 0.95rem; }\n\n  /* il resto del tuo CSSâ€¦ */\n  h1.title { display: none; }\n  .title-row{ display:flex; align-items:center; justify-content:space-between; gap:1rem; margin:.5rem 0 1rem; }\n  .title-row h1{ margin:0; font-size:2.2rem; line-height:1.1; color: var(--bs-heading-color, #0b7285); }\n  .title-row img{ height:96px; }\n  @media (max-width:576px){ .title-row{ flex-direction:column; align-items:flex-start; } .title-row img{ height:64px; } }\n</style>\n"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}